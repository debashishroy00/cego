<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CEGO Benchmark Report</title>
    <style>
        
        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: white;
            min-height: 100vh;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 3px solid #007acc;
            padding-bottom: 20px;
        }

        h1 {
            color: #007acc;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
            font-size: 1.1em;
        }

        .tabs {
            display: flex;
            border-bottom: 2px solid #ddd;
            margin-bottom: 20px;
        }

        .tab-button {
            background: none;
            border: none;
            padding: 12px 24px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            font-size: 1.1em;
            transition: all 0.3s;
        }

        .tab-button.active {
            border-bottom-color: #007acc;
            color: #007acc;
            font-weight: bold;
        }

        .tab-button:hover {
            background-color: #f0f0f0;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .metric-card {
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .metric-card.pattern {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-left: 4px solid #2196f3;
        }

        .metric-card.entropy {
            background: linear-gradient(135deg, #f3e5f5, #e1bee7);
            border-left: 4px solid #9c27b0;
        }

        .metric-card h3 {
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .metric {
            margin-bottom: 10px;
        }

        .metric .value {
            display: block;
            font-size: 2em;
            font-weight: bold;
            color: #333;
        }

        .metric .label {
            font-size: 0.9em;
            color: #666;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .table th,
        .table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        .table th {
            background-color: #f8f9fa;
            font-weight: bold;
            color: #333;
        }

        .table-striped tbody tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        .junk-stats {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .domain-section {
            margin-bottom: 30px;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
        }

        .domain-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 15px;
        }

        .domain-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
        }

        .calibration-summary {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #2196f3;
        }

        .calibration-note {
            font-style: italic;
            color: #666;
            margin-top: 10px;
        }

        .calibration-explanation {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }

        .gates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .gate-card {
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid;
        }

        .gate-card.pass {
            background: #e8f5e8;
            border-left-color: #4caf50;
        }

        .gate-card.fail {
            background: #ffebee;
            border-left-color: #f44336;
        }

        .tweaks-section {
            margin: 20px 0;
        }

        .tweaks-yaml {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 6px;
            border: 1px solid #ddd;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
        }

        .config-json {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 6px;
            border: 1px solid #ddd;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            max-height: 400px;
            overflow-y: auto;
        }

        @media (max-width: 768px) {
            .metrics-grid,
            .domain-grid,
            .gates-grid {
                grid-template-columns: 1fr;
            }

            .tabs {
                flex-wrap: wrap;
            }

            .tab-button {
                flex: 1;
                min-width: 120px;
            }
        }
    
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>CEGO Benchmark Report</h1>
            <p class="subtitle">Generated: 2025-09-14T18:50:03.624329</p>
        </header>

        <div class="tabs">
            <button class="tab-button active" onclick="openTab(event, 'overview')">Overview</button>
            <button class="tab-button" onclick="openTab(event, 'domains')">By Domain</button>
            <button class="tab-button" onclick="openTab(event, 'calibration')">Calibration</button>
            <button class="tab-button" onclick="openTab(event, 'acceptance')">Gates & Tweaks</button>
            <button class="tab-button" onclick="openTab(event, 'config')">Configuration</button>
        </div>

        <div id="overview" class="tab-content active">
            
        <section>
            <h2>Executive Summary</h2>
            <div class="metrics-grid">
                <div class="metric-card pattern">
                    <h3>Pattern Optimizer</h3>
                    <div class="metric">
                        <span class="value">59.8%</span>
                        <span class="label">Median Reduction</span>
                    </div>
                    <div class="metric">
                        <span class="value">0.060</span>
                        <span class="label">Mean Retention</span>
                    </div>
                    <div class="metric">
                        <span class="value">16.7ms</span>
                        <span class="label">P90 Latency</span>
                    </div>
                </div>

                <div class="metric-card entropy">
                    <h3>Entropy Optimizer</h3>
                    <div class="metric">
                        <span class="value">80.3%</span>
                        <span class="label">Median Reduction</span>
                    </div>
                    <div class="metric">
                        <span class="value">0.040</span>
                        <span class="label">Mean Retention</span>
                    </div>
                    <div class="metric">
                        <span class="value">20.8ms</span>
                        <span class="label">P90 Latency</span>
                    </div>
                </div>
            </div>

            <h3>Detailed Statistics</h3>
            <table border="1" class="dataframe table table-striped">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>optimizer</th>
      <th>success_rate</th>
      <th>reduction_median</th>
      <th>reduction_mean</th>
      <th>retention_mean</th>
      <th>retention_min</th>
      <th>latency_p90</th>
      <th>junk_kept_rate_median</th>
      <th>intent_preservation_rate</th>
      <th>confidence_mean</th>
      <th>total_runs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>pattern</td>
      <td>1.0</td>
      <td>0.597750</td>
      <td>0.591247</td>
      <td>0.06</td>
      <td>0.0</td>
      <td>16.71283</td>
      <td>0.0</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>150</td>
    </tr>
    <tr>
      <th>1</th>
      <td>entropy</td>
      <td>1.0</td>
      <td>0.802868</td>
      <td>0.799178</td>
      <td>0.04</td>
      <td>0.0</td>
      <td>20.79329</td>
      <td>0.0</td>
      <td>0.86</td>
      <td>0.17885</td>
      <td>150</td>
    </tr>
  </tbody>
</table>

            <h3>Junk Handling Performance</h3>
            <div class="junk-stats">
                <p><strong>Pattern Junk Kept Rate:</strong> 0.0</p>
                <p><strong>Entropy Junk Kept Rate:</strong> 0.0</p>
                <p><strong>Pattern Intent Preservation:</strong> 1.0</p>
                <p><strong>Entropy Intent Preservation:</strong> 0.86</p>
            </div>
        </section>
    
        </div>

        <div id="domains" class="tab-content">
            <h2>Performance by Domain</h2>
        <div class="domain-section">
            <h3>Domain: insurance</h3>
            <div class="domain-grid">
                <div class="domain-card">
                    <h4>Pattern</h4>
                    <p>Reduction: 59.4%</p>
                    <p>Retention: 0.000</p>
                    <p>Success: 100.0%</p>
                </div>
                <div class="domain-card">
                    <h4>Entropy</h4>
                    <p>Reduction: 79.7%</p>
                    <p>Retention: 0.000</p>
                    <p>Success: 100.0%</p>
                </div>
            </div>
        </div>
        
        <div class="domain-section">
            <h3>Domain: sdlc</h3>
            <div class="domain-grid">
                <div class="domain-card">
                    <h4>Pattern</h4>
                    <p>Reduction: 59.2%</p>
                    <p>Retention: 0.200</p>
                    <p>Success: 100.0%</p>
                </div>
                <div class="domain-card">
                    <h4>Entropy</h4>
                    <p>Reduction: 81.0%</p>
                    <p>Retention: 0.100</p>
                    <p>Success: 100.0%</p>
                </div>
            </div>
        </div>
        
        <div class="domain-section">
            <h3>Domain: mixed</h3>
            <div class="domain-grid">
                <div class="domain-card">
                    <h4>Pattern</h4>
                    <p>Reduction: 59.7%</p>
                    <p>Retention: 0.000</p>
                    <p>Success: 100.0%</p>
                </div>
                <div class="domain-card">
                    <h4>Entropy</h4>
                    <p>Reduction: 80.3%</p>
                    <p>Retention: 0.000</p>
                    <p>Success: 100.0%</p>
                </div>
            </div>
        </div>
        
        <div class="domain-section">
            <h3>Domain: dupes</h3>
            <div class="domain-grid">
                <div class="domain-card">
                    <h4>Pattern</h4>
                    <p>Reduction: 60.0%</p>
                    <p>Retention: 0.000</p>
                    <p>Success: 100.0%</p>
                </div>
                <div class="domain-card">
                    <h4>Entropy</h4>
                    <p>Reduction: 80.4%</p>
                    <p>Retention: 0.000</p>
                    <p>Success: 100.0%</p>
                </div>
            </div>
        </div>
        
        <div class="domain-section">
            <h3>Domain: format</h3>
            <div class="domain-grid">
                <div class="domain-card">
                    <h4>Pattern</h4>
                    <p>Reduction: 59.7%</p>
                    <p>Retention: 0.100</p>
                    <p>Success: 100.0%</p>
                </div>
                <div class="domain-card">
                    <h4>Entropy</h4>
                    <p>Reduction: 80.3%</p>
                    <p>Retention: 0.100</p>
                    <p>Success: 100.0%</p>
                </div>
            </div>
        </div>
        
        </div>

        <div id="calibration" class="tab-content">
            
        <h2>Confidence Calibration Analysis</h2>
        <div class="calibration-summary">
            <p><strong>Expected Calibration Error (ECE):</strong> 0.1389</p>
            <p class="calibration-note">
                Lower is better. ECE measures how well confidence scores align with actual performance.
            </p>
        </div>

        <h3>Calibration by Confidence Bins</h3>
        <table border="1" class="dataframe table table-striped">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bin_lower</th>
      <th>bin_upper</th>
      <th>count</th>
      <th>avg_confidence</th>
      <th>avg_accuracy</th>
      <th>calibration_error</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.1</td>
      <td>0.2</td>
      <td>141</td>
      <td>0.173511</td>
      <td>0.042553</td>
      <td>0.130957</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.2</td>
      <td>0.3</td>
      <td>9</td>
      <td>0.262500</td>
      <td>0.000000</td>
      <td>0.262500</td>
    </tr>
  </tbody>
</table>

        <div class="calibration-explanation">
            <h4>Interpretation Guide</h4>
            <ul>
                <li><strong>Well calibrated:</strong> Average confidence ≈ Average accuracy</li>
                <li><strong>Overconfident:</strong> Average confidence > Average accuracy</li>
                <li><strong>Underconfident:</strong> Average confidence < Average accuracy</li>
            </ul>
        </div>
    
        </div>

        <div id="acceptance" class="tab-content">
            <h2>Acceptance Gates & Suggested Tweaks</h2><h3>Acceptance Gate Results</h3><div class='gates-grid'>
            <div class="gate-card pass">
                <h4>entropy_reduction</h4>
                <p><strong>Status:</strong> PASS</p>
                <p><strong>Actual:</strong> 80.3%</p>
                <p><strong>Required:</strong> >=60%</p>
            </div>
            
            <div class="gate-card fail">
                <h4>entropy_retention</h4>
                <p><strong>Status:</strong> FAIL</p>
                <p><strong>Actual:</strong> 0.040</p>
                <p><strong>Required:</strong> >=0.92</p>
            </div>
            
            <div class="gate-card pass">
                <h4>entropy_junk_rate</h4>
                <p><strong>Status:</strong> PASS</p>
                <p><strong>Actual:</strong> 0.0%</p>
                <p><strong>Required:</strong> <=10%</p>
            </div>
            
            <div class="gate-card pass">
                <h4>pattern_reduction</h4>
                <p><strong>Status:</strong> PASS</p>
                <p><strong>Actual:</strong> 59.8%</p>
                <p><strong>Required:</strong> >=20%</p>
            </div>
            
            <div class="gate-card fail">
                <h4>pattern_retention</h4>
                <p><strong>Status:</strong> FAIL</p>
                <p><strong>Actual:</strong> 0.060</p>
                <p><strong>Required:</strong> >=0.90</p>
            </div>
            
            <div class="gate-card pass">
                <h4>pattern_junk_rate</h4>
                <p><strong>Status:</strong> PASS</p>
                <p><strong>Actual:</strong> 0.0%</p>
                <p><strong>Required:</strong> <=15%</p>
            </div>
            
            <div class="gate-card fail">
                <h4>entropy_intent_preservation</h4>
                <p><strong>Status:</strong> FAIL</p>
                <p><strong>Actual:</strong> 86.0%</p>
                <p><strong>Required:</strong> >=95%</p>
            </div>
            
            <div class="gate-card pass">
                <h4>pattern_intent_preservation</h4>
                <p><strong>Status:</strong> PASS</p>
                <p><strong>Actual:</strong> 100.0%</p>
                <p><strong>Required:</strong> >=95%</p>
            </div>
            
            <div class="gate-card pass">
                <h4>latency_ratio</h4>
                <p><strong>Status:</strong> PASS</p>
                <p><strong>Actual:</strong> 1.24x</p>
                <p><strong>Required:</strong> <=1.25x</p>
            </div>
            </div><h3>Suggested Parameter Tweaks</h3><div class='tweaks-section'><p>The following parameter adjustments are suggested to meet acceptance criteria:</p><pre class='tweaks-yaml'>lambda_decay: 0.95  # was 0.92, less aggressive pruning\nmmr_weight: 0.6  # was 0.5, more diversity\npattern_keep_ratio: 0.5  # was 0.4, keep more items\ndomain_boost_factor: 1.3  # was 1.0, boost primary domain\nsoft_keep_threshold: 0.25  # was 0.30, softer intent preservation</pre></div>
        </div>

        <div id="config" class="tab-content">
            
        <h2>Benchmark Configuration</h2>
        <div class="config-section">
            <h3>Run Parameters</h3>
            <ul>
                <li><strong>Total Tests:</strong> 300</li>
                <li><strong>Successful Tests:</strong> 300</li>
                <li><strong>Datasets:</strong> 6</li>
                <li><strong>Repeat Count:</strong> 3</li>
            </ul>

            <h3>Full Configuration</h3>
            <pre class="config-json">{
  "endpoints": {
    "pattern": "http://127.0.0.1:8003/optimize",
    "entropy": "http://127.0.0.1:8003/optimize/entropy"
  },
  "timeout": 30.0,
  "max_retries": 3,
  "retry_delay": 1.0,
  "datasets": [
    "cego_bench/datasets/insurance.jsonl",
    "cego_bench/datasets/sdlc.jsonl",
    "cego_bench/datasets/mixed.jsonl",
    "cego_bench/datasets/noisy.jsonl",
    "cego_bench/datasets/dupes.jsonl",
    "cego_bench/datasets/format.jsonl"
  ],
  "scoring": {
    "method_order": [
      "embed",
      "tfidf",
      "rouge"
    ],
    "embed_model": "all-MiniLM-L6-v2"
  },
  "runs": {
    "repeat": 3,
    "max_items": 50
  },
  "reporting": {
    "save_html": true,
    "save_artifacts": true,
    "save_csv": true
  },
  "acceptance_gates": {
    "entropy": {
      "min_reduction_median": 60.0,
      "min_retention_mean": 0.92,
      "max_junk_kept_rate": 0.1
    },
    "pattern": {
      "min_reduction_median": 20.0,
      "min_retention_mean": 0.9,
      "max_junk_kept_rate": 0.15
    },
    "general": {
      "min_intent_preservation": 0.95,
      "max_latency_ratio": 1.25
    }
  },
  "output": {
    "base_dir": "output\\patent_runs\\patent_run_20250914_184957",
    "include_timestamp": false
  }
}</pre>
        </div>
    
        </div>
    </div>

    <script>
        
        function openTab(evt, tabName) {
            var i, tabcontent, tablinks;

            // Hide all tab content
            tabcontent = document.getElementsByClassName("tab-content");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].classList.remove("active");
            }

            // Remove active class from all tab buttons
            tablinks = document.getElementsByClassName("tab-button");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].classList.remove("active");
            }

            // Show the selected tab and mark button as active
            document.getElementById(tabName).classList.add("active");
            evt.currentTarget.classList.add("active");
        }

        // Initialize first tab as active on page load
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelector('.tab-button').click();
        });
    
    </script>
</body>
</html>